Не совсем понятно откуда должны приходить данные.
А также по каким условиям определять каким форматом отослать данные.
